+++
#テンプレート：デフォルト
title = 'Cisco_マルチエリアOSPF'
date = 2025-08-30T14:39:30+09:00
draft = false
#weight = 99 # 順番を意図的に変更したい場合は変更する
categories = ["Network"]
tags = ["Author:nakata216", "Level:中級", "Type:Knowledge", "CCNP"]
+++

- [概要](#概要)

## 概要

本記事ではマルチエリアOSPFについて記載します。
また、CCNAで学習するOSPFの範囲を履修していることを前提としています。

## 本記事で学べる事

-   各ルータの役割
-   LSAの詳細
-   各エリアの役割

## 各ルータの役割について
マルチエリアOSPFでは、様々な役割を持つエリアや異なるルーティングプロトコルに隣接することが前提となります。そのため、シングルエリアとは異なり、ルータには様々な役割が与えられます。

-    バックボーンルータ<br>
    マルチエリアOSPFでは全てのエリアが隣接していなければならない、中心となるエリアでバックボーンエリアというものが存在します。<br>
    この、バックボーンエリアに一つ以上のインターフェースが属してるルータが該当します。
-   ABR（Area Border Router）<br>
    インターフェースが二つ以上のエリアに属しているルータが該当します。<br>
-   ASBR（Autonomous System Boundary Router）<br>
    異なるルーティングプロトコルと隣接しているルータが該当します。<br>
-   内部ルータ<br>
    単一のエリアのみに属しているルータが該当します。<br>

![マルチエリアOSPFルータ](/img/cisco_multiarea_ospf/multiarea_ospf_routers.png)<br>

## LSAについて

OSPFでは、LSDBの情報をLSAで共有します。ですが、マルチエリアでは各エリアで異なるLSDBを保持します。各エリアでLSDBの情報が異なる理由は、エリア間では様々なLSAが用途によって使い分けられるためです。<br>
ciscoでは下記表の8つのLSAタイプが存在します。<br>

-   LSAタイプ

|LSA名（LSA Type）|表示|生成ルータ|送信範囲|説明|
|:---:|:---:|:---:|:---:|:---|
|ルータLSA（LSA Type1）|Router|全OSPFルータ|同一エリア内|このLSAには自身のインターフェース情報やルータID情報が含まれおり、同一エリア内のルータに自身の情報を通知するために使用されます。|
|ネットワークLSA（LSA Type2）|Net|DR|同一エリア内|DRのルータIDやIPアドレスが含まれており、同一エリア内のルータへDR情報を通知するために使用されます。|
|サマリーLSA（LSA Type3）|Summary|ABR|全エリア|エリア内に存在するNWアドレス、サブネットマスク、コスト等の情報が含まれており、他エリアに伝えるために使用されます。|
|ASBRサマリーLSA（LSA Type4）|Summary ASBR|ABR|ASBRの属するエリア以外|ASBRのルータIDやコストの情報が含まれており、ASBRが属するエリア以外の他エリアにASBRの情報を伝えるために使用されます。|
|AS外部LSA（LSA Type5）|Type-5 AS External|ASBR|全エリア|OSPF以外の経路情報をOSPF内に伝えるために使用されます。|
|NSSA外部LSA（LSA Type7）|Type-7 AS External|NSSA ASBR|NSSA/トータリーNSSA内|OSPF以外の経路情報をOSPF内に伝えるために使用されます。ただし、Type5と違い、NSSAもしくはトータリーNSSAエリアからの経路で使用されます。|
|リンクLSA（LSA Type8）|Link|全OSPFルータ|全エリア||OSPFv3で使用されるLSA。IPv6のプレフィックスやリンクローカルアドレスなどを通知するのに使用されます。※このLSAはバーチャルリンクでは発信できない。|
|エリア内LSA（LSA Type9）|Intra Area Prefix|全OSPFルータ|同一エリア内|OSPFv3で使用されるLSA。OSPFv2で使用されていたType1,2の情報をこのLSAで通知します。|

## エリアの役割
ルータやLSAの役割を理解した次はエリアの役割を学びましょう。<br>
OSPFには様々な役割を持つエリアが存在します。<br>
各エリアによって流せるLSAが決まっていたり、隣接していなければならないという制約があったりといった特徴があります。

-   バックボーンエリア<br>
    OSPFで中心となるエリア。エリアIDは0が使用され、全てのエリアはこのバックボーンエリアに隣接している必要があります。<br>
    バックボーンエリア内で流れるLSAはType1,2,3,4,5となります。<br>
-   標準エリア<br>
    OSPFにおける通常のエリア。<br>
    標準エリア内で流れるLSAはType1,2,3,4,5となります。<br>
-   スタブエリア<br>
    Type5を流すことが出来ないエリアです。<br>
    スタブとはネットワークで末端を意味しており、OSPFでは余計なLSAを流さず、LSDBのサイズを減らすように設計されています。<br>
    このスタブエリアはType5を流せないため、外部ルート（OSPF以外の経路）はデフォルトルートとして、経路を広報し、ASBRの設置が行えません。また、バーチャルリンクのリンクの設定も行えません。<br>
    スタブエリアで流れるLSAはType1,2,3となります。<br>
-   トータリースタブエリア
    完全スタブエリアとも呼ばれており、スタブエリアと同様、Type5を流すことが出来ないエリアです。<br>
    通常のスタブエリアと違い、トータリースタブエリアは全ての経路をデフォルトルートとして経路を広報します。<br>
    トータリースタブエリアで流れるLSAはType1,2,3となります。<br>
-   NSSA（Not-So-Stubby Area）
    NSSAはスタブエリアにASBRを設置できるようにしたエリアです。<br>
    ですが、スタブエリアと同様にType5を流すことはできないため、外部ルートをType7として経路を広報します。また、他エリアからの外部ルートについては、ABRにデフォルトルート伝播設定を行わなければ、経路を受信できない点がスタブエリアとの違いなります。<br>
    NSSAで流れるLSAはType1,2,3,7となります。<br>
-   トータリーNSSA<br>
    トータリースタブエリアと同様、他エリアからの経路は全てデフォルトルートとして、広報されます。<br>
    また、通常のNSSAと違い、デフォルトで経路をデフォルトルートに変換するため、ABRへのデフォルトルート伝播設定は不要になります。<br>

## まとめ

LSA、ルータの役割、エリアの役割はOSPFを構築する上で、必要不可欠の知識となります。ですが、この内容を理解してしまえば、OSPFv2,v3も仕組みが大きく変わることはなく、バーチャルリンクや認証、コストの設定もある種、拡張機能のようなものなので、内容の理解は容易と思います。